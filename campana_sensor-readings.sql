-- phpMyAdmin SQL Dump
-- version 5.2.1
-- https://www.phpmyadmin.net/
--
-- Host: 127.0.0.1
-- Generation Time: Oct 30, 2024 at 12:26 PM
-- Server version: 10.4.32-MariaDB
-- PHP Version: 8.0.30

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Database: `campana_sensor-readings`
--

-- --------------------------------------------------------

--
-- Table structure for table `sensors`
--

CREATE TABLE `sensors` (
  `id` int(11) NOT NULL,
  `humidity` float NOT NULL,
  `amountofrain` float NOT NULL,
  `waterlevel` int(11) NOT NULL,
  `windspeed` float NOT NULL,
  `temperature` float NOT NULL,
  `datetime` datetime NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `sensors`
--

INSERT INTO `sensors` (`id`, `humidity`, `amountofrain`, `waterlevel`, `windspeed`, `temperature`, `datetime`) VALUES
(2410, 77.6, 0, 134, 0, 30.1, '2024-10-30 17:48:01'),
(2411, 77.5, 0, 130, 0, 30.1, '2024-10-30 17:48:06'),
(2412, 77.4, 0, 124, 0, 30.1, '2024-10-30 17:48:12'),
(2413, 77.5, 0, 118, 0, 30.1, '2024-10-30 17:48:17'),
(2414, 77.5, 0, 115, 0, 30.1, '2024-10-30 17:48:24'),
(2415, 77.5, 0, 112, 0, 30.1, '2024-10-30 17:48:30'),
(2416, 77.6, 0, 109, 0, 30.1, '2024-10-30 17:48:35'),
(2417, 77.5, 0, 106, 0, 30, '2024-10-30 17:48:41'),
(2418, 77.5, 0, 104, 0, 30.1, '2024-10-30 17:48:46'),
(2419, 77.6, 0, 102, 0, 30.1, '2024-10-30 17:48:52'),
(2420, 77.6, 0, 99, 0, 30.1, '2024-10-30 17:48:57'),
(2421, 77.6, 0, 98, 0, 30, '2024-10-30 17:49:03'),
(2422, 77.6, 0, 97, 0, 30.1, '2024-10-30 17:49:09'),
(2423, 77.4, 0, 102, 0, 30, '2024-10-30 17:49:14'),
(2424, 77.5, 0, 488, 0, 30.1, '2024-10-30 17:49:20'),
(2425, 77.5, 0, 366, 0, 30.1, '2024-10-30 17:49:25'),
(2426, 77.4, 0, 581, 0, 30.2, '2024-10-30 17:49:31'),
(2427, 77.6, 0, 580, 0, 30.1, '2024-10-30 17:49:36'),
(2428, 77.5, 0, 584, 0, 30.1, '2024-10-30 17:49:42'),
(2429, 77.5, 0, 660, 0, 30.1, '2024-10-30 17:49:48'),
(2430, 77.5, 0, 714, 0, 30, '2024-10-30 17:49:53'),
(2431, 77.5, 0, 694, 0, 30, '2024-10-30 17:49:59'),
(2432, 77.6, 0, 757, 0, 30, '2024-10-30 17:50:04'),
(2433, 77.5, 0, 734, 0, 30.1, '2024-10-30 17:50:10'),
(2434, 77.6, 0, 691, 0, 30.1, '2024-10-30 17:50:15'),
(2435, 77.6, 0, 676, 0, 30.1, '2024-10-30 17:50:21'),
(2436, 77.6, 0, 668, 0, 30, '2024-10-30 17:50:27'),
(2437, 77.7, 0, 105, 0, 30, '2024-10-30 17:50:32'),
(2438, 77.6, 0, 126, 0, 30, '2024-10-30 17:50:38'),
(2439, 79.6, 0, 109, 0, 29.3, '2024-10-30 17:53:02'),
(2440, 79.5, 0, 88, 0, 29.4, '2024-10-30 17:53:08'),
(2441, 79.4, 0, 69, 0, 29.4, '2024-10-30 17:53:13'),
(2442, 79.2, 0, 56, 0, 29.4, '2024-10-30 17:53:19'),
(2443, 79.2, 0, 49, 0, 29.4, '2024-10-30 17:53:24'),
(2444, 79.1, 0, 44, 0, 29.4, '2024-10-30 17:53:30'),
(2445, 79.1, 0, 41, 0, 29.4, '2024-10-30 17:53:35'),
(2446, 79.1, 0, 41, 0, 29.4, '2024-10-30 17:53:41'),
(2447, 78.9, 0, 39, 0, 29.6, '2024-10-30 17:53:47'),
(2448, 79, 0, 38, 0, 29.5, '2024-10-30 17:53:52'),
(2449, 78.9, 0, 37, 0, 29.5, '2024-10-30 17:53:58'),
(2450, 78.8, 0, 36, 0, 29.5, '2024-10-30 17:54:03'),
(2451, 78.9, 0, 33, 0, 29.6, '2024-10-30 17:54:09'),
(2452, 79, 0, 33, 0, 29.6, '2024-10-30 17:54:14'),
(2453, 78.9, 0, 32, 0, 29.6, '2024-10-30 17:54:20'),
(2454, 78.8, 0, 32, 0, 29.6, '2024-10-30 17:54:26'),
(2455, 78.9, 0, 32, 0, 29.6, '2024-10-30 17:54:31'),
(2456, 79, 0, 31, 0, 29.6, '2024-10-30 17:54:37'),
(2457, 79, 0, 31, 0, 29.6, '2024-10-30 17:54:42'),
(2458, 79.1, 0, 30, 0, 29.6, '2024-10-30 17:54:48'),
(2459, 79, 0, 30, 0, 29.6, '2024-10-30 17:54:53'),
(2460, 79.1, 0, 29, 0, 29.6, '2024-10-30 17:54:59'),
(2461, 79, 0, 29, 0, 29.6, '2024-10-30 17:55:04'),
(2462, 79, 0, 28, 0, 29.6, '2024-10-30 17:55:10'),
(2463, 79, 0, 28, 0, 29.6, '2024-10-30 17:55:16'),
(2464, 79, 0, 29, 0, 29.6, '2024-10-30 17:55:21'),
(2465, 78.9, 0, 29, 0, 29.6, '2024-10-30 17:55:27'),
(2466, 78.8, 0, 29, 0, 29.7, '2024-10-30 17:55:32'),
(2467, 78.8, 0, 28, 0, 29.7, '2024-10-30 17:55:38'),
(2468, 78.9, 0, 28, 0, 29.7, '2024-10-30 17:55:43'),
(2469, 78.9, 0, 28, 0, 29.7, '2024-10-30 17:55:49'),
(2470, 78.8, 0, 28, 0, 29.7, '2024-10-30 17:55:55'),
(2471, 78.7, 0, 28, 0, 29.6, '2024-10-30 17:56:00'),
(2472, 78.8, 0, 28, 0, 29.6, '2024-10-30 17:56:06'),
(2473, 78.8, 0, 28, 0, 29.7, '2024-10-30 17:56:12'),
(2474, 78.8, 0, 558, 0, 29.6, '2024-10-30 17:56:17'),
(2475, 78.7, 0, 486, 0, 29.6, '2024-10-30 17:56:23'),
(2476, 78.9, 0, 438, 0, 29.6, '2024-10-30 17:56:28'),
(2477, 78.9, 0, 428, 0, 29.6, '2024-10-30 17:56:34'),
(2478, 78.9, 0, 220, 0, 29.7, '2024-10-30 17:56:39'),
(2479, 78.8, 0, 210, 0, 29.7, '2024-10-30 17:56:45'),
(2480, 78.8, 0, 212, 0, 29.8, '2024-10-30 17:56:51'),
(2481, 78.9, 0, 217, 2.83, 29.7, '2024-10-30 17:56:56'),
(2482, 79, 0, 220, 0, 29.7, '2024-10-30 17:57:02'),
(2483, 78.9, 0, 194, 0, 29.7, '2024-10-30 17:57:07'),
(2484, 78.9, 0, 208, 0, 29.7, '2024-10-30 17:57:13'),
(2485, 79, 0, 202, 0, 29.7, '2024-10-30 17:57:19'),
(2486, 79, 0, 340, 0, 29.7, '2024-10-30 17:57:27'),
(2487, 78.8, 0, 45, 0, 29.7, '2024-10-30 17:57:33'),
(2488, 78.9, 0, 32, 0, 29.7, '2024-10-30 17:57:41'),
(2489, 79, 0, 28, 0, 29.7, '2024-10-30 17:58:02'),
(2490, 78.9, 0, 588, 0, 29.7, '2024-10-30 17:58:11'),
(2491, 79.1, 0, 421, 0, 29.7, '2024-10-30 17:58:16'),
(2492, 79.1, 0, 136, 2.83, 29.7, '2024-10-30 17:58:35'),
(2493, 78.9, 0, 136, 0, 29.7, '2024-10-30 17:58:51'),
(2494, 79, 0, 126, 0, 29.7, '2024-10-30 17:58:56'),
(2495, 79, 0, 25, 0, 29.8, '2024-10-30 17:59:02'),
(2496, 79, 0, 25, 0, 29.7, '2024-10-30 17:59:10'),
(2497, 79, 0, 22, 0, 29.7, '2024-10-30 17:59:16'),
(2498, 78.9, 0, 22, 0, 29.7, '2024-10-30 17:59:22'),
(2499, 79, 0, 24, 0, 29.7, '2024-10-30 17:59:27'),
(2500, 78.9, 0, 24, 0, 29.8, '2024-10-30 17:59:33'),
(2501, 78.9, 0, 653, 0, 29.7, '2024-10-30 17:59:39'),
(2502, 78.9, 0, 367, 0, 29.8, '2024-10-30 17:59:47'),
(2503, 79.1, 0, 376, 0, 29.7, '2024-10-30 17:59:53'),
(2504, 79, 0, 357, 8.48, 29.7, '2024-10-30 17:59:56'),
(2505, 79, 0, 346, 0, 29.7, '2024-10-30 18:00:11'),
(2506, 78.8, 0, 341, 0, 29.7, '2024-10-30 18:00:17'),
(2507, 78.8, 0, 338, 0, 29.7, '2024-10-30 18:00:23'),
(2508, 78.9, 0, 337, 0, 29.7, '2024-10-30 18:00:39'),
(2509, 78.9, 0, 354, 0, 29.8, '2024-10-30 18:00:39'),
(2510, 90, 10, 1024, 90, 0, '0000-00-00 00:00:00'),
(2511, 89, 1, 150, 10, 10, '0000-00-00 00:00:00'),
(2512, 89, 1, 300, 10, 10, '0000-00-00 00:00:00'),
(2513, 59, 15, 0, 0, 0, '0000-00-00 00:00:00'),
(2514, 59, 15, 1024, 60, 17, '0000-00-00 00:00:00');

--
-- Triggers `sensors`
--
DELIMITER $$
CREATE TRIGGER `maintain_max_rows` AFTER INSERT ON `sensors` FOR EACH ROW BEGIN
    DECLARE excess INT;
    
    SELECT COUNT(*) - 500 INTO excess FROM sensors;
    
    IF excess > 0 THEN
        DELETE FROM sensors
        WHERE id IN (
            SELECT * FROM (
                SELECT id 
                FROM sensors 
                ORDER BY id ASC 
                LIMIT excess
            ) AS tmp
        );
    END IF;
END
$$
DELIMITER ;

--
-- Indexes for dumped tables
--

--
-- Indexes for table `sensors`
--
ALTER TABLE `sensors`
  ADD PRIMARY KEY (`id`);

--
-- AUTO_INCREMENT for dumped tables
--

--
-- AUTO_INCREMENT for table `sensors`
--
ALTER TABLE `sensors`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=2515;
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
